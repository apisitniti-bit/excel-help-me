(()=>{var e={};e.id=647,e.ids=[647],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9295:(e,s,l)=>{"use strict";l.r(s),l.d(s,{GlobalError:()=>r.Z,__next_app__:()=>u,originalPathname:()=>d,pages:()=>o,routeModule:()=>h,tree:()=>i}),l(6252),l(2029),l(7629),l(2523);var a=l(3191),t=l(8716),r=l(3315),n=l(5231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);l.d(s,c);let i=["",{children:["vlookup",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(l.bind(l,6252)),"C:\\Users\\Ong\\excel-help-me\\src\\app\\vlookup\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(l.bind(l,2029)),"C:\\Users\\Ong\\excel-help-me\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(l.bind(l,7629)),"C:\\Users\\Ong\\excel-help-me\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(l.bind(l,2523)),"C:\\Users\\Ong\\excel-help-me\\src\\app\\not-found.tsx"]}],o=["C:\\Users\\Ong\\excel-help-me\\src\\app\\vlookup\\page.tsx"],d="/vlookup/page",u={require:l,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/vlookup/page",pathname:"/vlookup",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},3832:(e,s,l)=>{Promise.resolve().then(l.bind(l,6160))},6160:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>k});var a=l(326),t=l(7577),r=l.n(t),n=l(4542),c=l(2881);let i=(0,c.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),o=(0,c.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),d=(0,c.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var u=l(4230),h=l(6333);let p=(0,c.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),x=(0,c.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var m=l(9604),g=l(7972),j=l(1664),v=l(9280),f=l(4794),C=l(8443),y=l(3261),N=l(9752),b=l(8638);function k(){let[e,s]=(0,t.useState)(null),[l,c]=(0,t.useState)(null),[k,S]=(0,t.useState)([]),[w,P]=(0,t.useState)({}),[_,M]=(0,t.useState)("upload"),[O,Z]=(0,t.useState)(null),[z,V]=(0,t.useState)(!1),[E,U]=(0,t.useState)(""),[q,F]=(0,t.useState)(""),[$,R]=(0,t.useState)(""),[A,T]=(0,t.useState)(""),[Y,G]=(0,t.useState)([{returnCol:-1,targetCol:-1}]),[L,I]=(0,t.useState)(""),[K,X]=(0,t.useState)(null),[H,B]=(0,t.useState)([]),[D,J]=(0,t.useState)(0),[Q,W]=(0,t.useState)(0),[ee,es]=(0,t.useState)(0),[el,ea]=(0,t.useState)(new Map),[et,er]=(0,t.useState)([]),en=(0,t.useCallback)(async e=>{Z(null),V(!0);try{let l=await (0,b.e_)(e),a=(0,b.cE)(l),t={};for(let e of a)t[e]=(0,b.$O)(l,e);s(e),c(l),S(a),P(t),1===a.length&&(U(a[0]),R(a[0]),I(a[0])),M("configure")}catch(e){Z(e instanceof Error?e.message:"Failed to read file.")}finally{V(!1)}},[]),ec=(0,t.useCallback)(()=>{s(null),c(null),S([]),P({}),M("upload"),Z(null),U(""),F(""),R(""),T(""),G([{returnCol:-1,targetCol:-1}]),I(""),X(null),B([])},[]),ei=(0,t.useMemo)(()=>k.map(e=>({value:e,label:`${e} (${w[e]?.data.length??0} rows)`})),[k,w]),eo=e=>{let s=w[e];return s?s.headers.map((e,s)=>({value:String(s),label:`${(0,b.eb)(s)} — ${e}`})):[]},ed=(0,t.useMemo)(()=>eo(E),[E,w]),eu=(0,t.useMemo)(()=>eo($),[$,w]),eh=(0,t.useMemo)(()=>eo(L),[L,w]),ep=(0,t.useMemo)(()=>eo($),[$,w]),ex=e=>{G(s=>s.filter((s,l)=>l!==e))},em=(e,s,l)=>{G(a=>a.map((a,t)=>t===e?{...a,[s]:l}:a))},eg=(0,t.useMemo)(()=>!!E&&""!==q&&!!$&&""!==A&&!!L&&Y.every(e=>e.returnCol>=0&&e.targetCol>=0),[E,q,$,A,L,Y]),ej=(0,t.useCallback)(()=>{let e=w[E],s=w[$],l=w[L];if(!e||!s||!l)return;let a=function(e,s,l,a,t){let r=new Map,n=0;for(let e of l){let s=String(e[a]??"").trim();""!==s&&(r.has(s)?n++:r.set(s,e))}let c=0,i=0,o=[];for(let l=0;l<e.length;l++){let a=String(e[l][s]??"").trim();if(""===a){i++,o.push({row:l,matched:!1,values:t.map(()=>"")});continue}let n=r.get(a);if(n){c++;let e=t.map(e=>String(n[e.returnCol]??""));o.push({row:l,matched:!0,values:e})}else i++,o.push({row:l,matched:!1,values:t.map(()=>"")})}return{results:o,matchCount:c,noMatchCount:i,duplicateKeysInReference:n}}(e.data,Number(q),s.data,Number(A),Y);J(a.matchCount),W(a.noMatchCount),es(a.duplicateKeysInReference);let t=l.data.map(e=>[...e]),r=Y.map(e=>e.targetCol),n=new Map;for(let e of a.results){let s=e.row;for(;t.length<=s;)t.push([]);let l=t[s];for(let s=0;s<r.length;s++){let a=r[s];for(;l.length<=a;)l.push("");l[a]=e.values[s]}n.set(s,{type:e.matched?"match":"no-match"})}let c=Math.max(l.headers.length-1,...r),i=[...l.headers];for(;i.length<=c;)i.push(`Column ${(0,b.eb)(i.length)}`);X(t),B(i),ea(n),er(r),M("preview")},[E,q,$,A,L,Y,w]),ev=(0,t.useCallback)(()=>{if(!l||!K)return;let e=Y.map(e=>e.targetCol),s=K.map(s=>e.map(e=>String(s[e]??""))),a=(0,b.fz)(l,L,e,s,1);(0,n.saveAs)(a,`vlookup_result_${Date.now()}.xlsx`)},[l,K,L,Y]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"VLOOKUP"}),a.jsx("p",{className:"text-muted-foreground",children:"Upload an Excel file and match data between sheets"})]}),a.jsx("div",{className:"flex items-center gap-2 text-sm",children:["upload","configure","preview"].map((s,l)=>(0,a.jsxs)(r().Fragment,{children:[l>0&&a.jsx("div",{className:"h-px w-6 bg-border"}),(0,a.jsxs)("button",{onClick:()=>{"upload"!==s&&("configure"===s&&e&&M("configure"),"preview"===s&&K&&M("preview"))},className:`rounded-full px-3 py-1 font-medium capitalize transition-colors ${_===s?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:text-foreground"}`,children:[l+1,". ",s]})]},s))}),O&&(0,a.jsxs)(y.bZ,{variant:"destructive",children:[a.jsx(i,{className:"h-4 w-4"}),a.jsx(y.Cd,{children:"Error"}),a.jsx(y.X,{children:O})]}),"upload"===_&&(0,a.jsxs)(N.Zb,{children:[a.jsx(N.Ol,{children:a.jsx(N.ll,{children:"Upload Excel File"})}),(0,a.jsxs)(N.aY,{children:[a.jsx(m.b,{onFileSelect:en,currentFile:e,onClear:ec,disabled:z}),z&&a.jsx("p",{className:"mt-3 text-sm text-muted-foreground animate-pulse",children:"Reading file..."})]})]}),"configure"===_&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(N.Zb,{children:[a.jsx(N.Ol,{children:a.jsx(N.ll,{className:"text-lg",children:"File Info"})}),(0,a.jsxs)(N.aY,{children:[a.jsx(m.b,{onFileSelect:en,currentFile:e,onClear:ec}),a.jsx("div",{className:"mt-3 flex gap-2",children:k.map(e=>(0,a.jsxs)(C.C,{variant:"secondary",children:[e," (",w[e]?.data.length??0," rows)"]},e))})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(N.Zb,{children:[a.jsx(N.Ol,{children:a.jsx(N.ll,{className:"text-lg",children:"Lookup Source"})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(f._,{children:"Sheet"}),a.jsx(v.P,{value:E,onValueChange:U,options:ei,placeholder:"Select lookup sheet"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(f._,{children:"Lookup Column"}),a.jsx(v.P,{value:q,onValueChange:F,options:ed,placeholder:"Select column to lookup",disabled:!E})]})]})]}),(0,a.jsxs)(N.Zb,{children:[a.jsx(N.Ol,{children:a.jsx(N.ll,{className:"text-lg",children:"Reference Source"})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(f._,{children:"Sheet"}),a.jsx(v.P,{value:$,onValueChange:R,options:ei,placeholder:"Select reference sheet"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(f._,{children:"Match Column"}),a.jsx(v.P,{value:A,onValueChange:T,options:eu,placeholder:"Select column to match",disabled:!$})]})]})]})]}),(0,a.jsxs)(N.Zb,{children:[(0,a.jsxs)(N.Ol,{className:"flex flex-row items-center justify-between",children:[a.jsx(N.ll,{className:"text-lg",children:"Return Columns → Target Columns"}),(0,a.jsxs)(j.z,{size:"sm",variant:"outline",onClick:()=>{G(e=>[...e,{returnCol:-1,targetCol:-1}])},className:"gap-1",children:[a.jsx(o,{className:"h-3.5 w-3.5"}),"Add Mapping"]})]}),(0,a.jsxs)(N.aY,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx(f._,{children:"Target Sheet"}),a.jsx(v.P,{value:L,onValueChange:I,options:ei,placeholder:"Select target sheet"})]}),Y.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-end gap-3 rounded-lg border bg-muted/30 p-3",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[a.jsx(f._,{className:"text-xs",children:"Return Column (from reference)"}),a.jsx(v.P,{value:e.returnCol>=0?String(e.returnCol):"",onValueChange:e=>em(s,"returnCol",Number(e)),options:ep,placeholder:"Select...",disabled:!$})]}),a.jsx("div",{className:"text-muted-foreground pb-2",children:"→"}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[a.jsx(f._,{className:"text-xs",children:"Target Column"}),a.jsx(v.P,{value:e.targetCol>=0?String(e.targetCol):"",onValueChange:e=>em(s,"targetCol",Number(e)),options:eh,placeholder:"Select...",disabled:!L})]}),Y.length>1&&a.jsx(j.z,{size:"icon",variant:"ghost",onClick:()=>ex(s),className:"mb-0.5 h-8 w-8 text-muted-foreground hover:text-destructive",children:a.jsx(d,{className:"h-4 w-4"})})]},s))]})]}),a.jsx("div",{className:"flex justify-end",children:(0,a.jsxs)(j.z,{onClick:ej,disabled:!eg,className:"gap-2",children:["Run VLOOKUP",a.jsx(u.Z,{className:"h-4 w-4"})]})})]}),"preview"===_&&K&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)(j.z,{variant:"outline",size:"sm",onClick:()=>M("configure"),className:"gap-1",children:[a.jsx(h.Z,{className:"h-4 w-4"}),"Back to Configure"]}),(0,a.jsxs)(C.C,{variant:"success",className:"gap-1",children:[a.jsx(p,{className:"h-3.5 w-3.5"}),D," matched"]}),Q>0&&(0,a.jsxs)(C.C,{variant:"destructive",className:"gap-1",children:[a.jsx(i,{className:"h-3.5 w-3.5"}),Q," not matched"]}),ee>0&&(0,a.jsxs)(C.C,{variant:"warning",className:"gap-1",children:[a.jsx(x,{className:"h-3.5 w-3.5"}),ee," duplicate keys in reference"]})]}),a.jsx(g.r,{headers:H,data:K,rowHighlights:el,highlightColumns:et}),a.jsx("div",{className:"flex justify-end",children:(0,a.jsxs)(j.z,{onClick:ev,className:"gap-2",children:["Export .xlsx",a.jsx(u.Z,{className:"h-4 w-4"})]})})]})]})}},6252:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>a});let a=(0,l(8570).createProxy)(String.raw`C:\Users\Ong\excel-help-me\src\app\vlookup\page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var l=e=>s(s.s=e),a=s.X(0,[11,707,213],()=>l(9295));module.exports=a})();