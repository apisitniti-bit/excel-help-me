(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[647],{9265:function(e,l,s){Promise.resolve().then(s.bind(s,1232))},1232:function(e,l,s){"use strict";s.r(l),s.d(l,{default:function(){return b}});var a=s(7437),t=s(2265),r=s(12),n=s(9205);let c=(0,n.Z)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),i=(0,n.Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),d=(0,n.Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var o=s(6858),u=s(2660);let h=(0,n.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),m=(0,n.Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var x=s(177),p=s(1833),g=s(2381),j=s(7550),v=s(5060),f=s(9174),C=s(5937),N=s(9820),y=s(5830);function b(){let[e,l]=(0,t.useState)(null),[s,n]=(0,t.useState)(null),[b,S]=(0,t.useState)([]),[k,w]=(0,t.useState)({}),[M,_]=(0,t.useState)("upload"),[Z,z]=(0,t.useState)(null),[O,P]=(0,t.useState)(!1),[V,E]=(0,t.useState)(""),[F,R]=(0,t.useState)(""),[Y,L]=(0,t.useState)(""),[T,U]=(0,t.useState)(""),[I,K]=(0,t.useState)([{returnCol:-1,targetCol:-1}]),[A,H]=(0,t.useState)(""),[X,q]=(0,t.useState)(null),[B,D]=(0,t.useState)([]),[$,G]=(0,t.useState)(0),[J,Q]=(0,t.useState)(0),[W,ee]=(0,t.useState)(0),[el,es]=(0,t.useState)(new Map),[ea,et]=(0,t.useState)([]),er=(0,t.useCallback)(async e=>{z(null),P(!0);try{let s=await (0,y.e_)(e),a=(0,y.cE)(s),t={};for(let e of a)t[e]=(0,y.$O)(s,e);l(e),n(s),S(a),w(t),1===a.length&&(E(a[0]),L(a[0]),H(a[0])),_("configure")}catch(e){z(e instanceof Error?e.message:"Failed to read file.")}finally{P(!1)}},[]),en=(0,t.useCallback)(()=>{l(null),n(null),S([]),w({}),_("upload"),z(null),E(""),R(""),L(""),U(""),K([{returnCol:-1,targetCol:-1}]),H(""),q(null),D([])},[]),ec=(0,t.useMemo)(()=>b.map(e=>{var l,s;return{value:e,label:"".concat(e," (").concat(null!==(s=null===(l=k[e])||void 0===l?void 0:l.data.length)&&void 0!==s?s:0," rows)")}}),[b,k]),ei=e=>{let l=k[e];return l?l.headers.map((e,l)=>({value:String(l),label:"".concat((0,y.eb)(l)," — ").concat(e)})):[]},ed=(0,t.useMemo)(()=>ei(V),[V,k]),eo=(0,t.useMemo)(()=>ei(Y),[Y,k]),eu=(0,t.useMemo)(()=>ei(A),[A,k]),eh=(0,t.useMemo)(()=>ei(Y),[Y,k]),em=e=>{K(l=>l.filter((l,s)=>s!==e))},ex=(e,l,s)=>{K(a=>a.map((a,t)=>t===e?{...a,[l]:s}:a))},ep=(0,t.useMemo)(()=>!!V&&""!==F&&!!Y&&""!==T&&!!A&&I.every(e=>e.returnCol>=0&&e.targetCol>=0),[V,F,Y,T,A,I]),eg=(0,t.useCallback)(()=>{let e=k[V],l=k[Y],s=k[A];if(!e||!l||!s)return;let a=function(e,l,s,a,t){var r,n;let c=new Map,i=0;for(let e of s){let l=String(null!==(r=e[a])&&void 0!==r?r:"").trim();""!==l&&(c.has(l)?i++:c.set(l,e))}let d=0,o=0,u=[];for(let s=0;s<e.length;s++){let a=String(null!==(n=e[s][l])&&void 0!==n?n:"").trim();if(""===a){o++,u.push({row:s,matched:!1,values:t.map(()=>"")});continue}let r=c.get(a);if(r){d++;let e=t.map(e=>{var l;return String(null!==(l=r[e.returnCol])&&void 0!==l?l:"")});u.push({row:s,matched:!0,values:e})}else o++,u.push({row:s,matched:!1,values:t.map(()=>"")})}return{results:u,matchCount:d,noMatchCount:o,duplicateKeysInReference:i}}(e.data,Number(F),l.data,Number(T),I);G(a.matchCount),Q(a.noMatchCount),ee(a.duplicateKeysInReference);let t=s.data.map(e=>[...e]),r=I.map(e=>e.targetCol),n=new Map;for(let e of a.results){let l=e.row;for(;t.length<=l;)t.push([]);let s=t[l];for(let l=0;l<r.length;l++){let a=r[l];for(;s.length<=a;)s.push("");s[a]=e.values[l]}n.set(l,{type:e.matched?"match":"no-match"})}let c=Math.max(s.headers.length-1,...r),i=[...s.headers];for(;i.length<=c;)i.push("Column ".concat((0,y.eb)(i.length)));q(t),D(i),es(n),et(r),_("preview")},[V,F,Y,T,A,I,k]),ej=(0,t.useCallback)(()=>{if(!s||!X)return;let e=I.map(e=>e.targetCol),l=X.map(l=>e.map(e=>{var s;return String(null!==(s=l[e])&&void 0!==s?s:"")})),a=(0,y.fz)(s,A,e,l,1);(0,r.saveAs)(a,"vlookup_result_".concat(Date.now(),".xlsx"))},[s,X,A,I]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"VLOOKUP"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Upload an Excel file and match data between sheets"})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 text-sm",children:["upload","configure","preview"].map((l,s)=>(0,a.jsxs)(t.Fragment,{children:[s>0&&(0,a.jsx)("div",{className:"h-px w-6 bg-border"}),(0,a.jsxs)("button",{onClick:()=>{"upload"!==l&&("configure"===l&&e&&_("configure"),"preview"===l&&X&&_("preview"))},className:"rounded-full px-3 py-1 font-medium capitalize transition-colors ".concat(M===l?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:text-foreground"),children:[s+1,". ",l]})]},l))}),Z&&(0,a.jsxs)(C.bZ,{variant:"destructive",children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)(C.Cd,{children:"Error"}),(0,a.jsx)(C.X,{children:Z})]}),"upload"===M&&(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{children:"Upload Excel File"})}),(0,a.jsxs)(N.aY,{children:[(0,a.jsx)(x.b,{onFileSelect:er,currentFile:e,onClear:en,disabled:O}),O&&(0,a.jsx)("p",{className:"mt-3 text-sm text-muted-foreground animate-pulse",children:"Reading file..."})]})]}),"configure"===M&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{className:"text-lg",children:"File Info"})}),(0,a.jsxs)(N.aY,{children:[(0,a.jsx)(x.b,{onFileSelect:er,currentFile:e,onClear:en}),(0,a.jsx)("div",{className:"mt-3 flex gap-2",children:b.map(e=>{var l,s;return(0,a.jsxs)(f.C,{variant:"secondary",children:[e," (",null!==(s=null===(l=k[e])||void 0===l?void 0:l.data.length)&&void 0!==s?s:0," rows)"]},e)})})]})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{className:"text-lg",children:"Lookup Source"})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{children:"Sheet"}),(0,a.jsx)(j.P,{value:V,onValueChange:E,options:ec,placeholder:"Select lookup sheet"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{children:"Lookup Column"}),(0,a.jsx)(j.P,{value:F,onValueChange:R,options:ed,placeholder:"Select column to lookup",disabled:!V})]})]})]}),(0,a.jsxs)(N.Zb,{children:[(0,a.jsx)(N.Ol,{children:(0,a.jsx)(N.ll,{className:"text-lg",children:"Reference Source"})}),(0,a.jsxs)(N.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{children:"Sheet"}),(0,a.jsx)(j.P,{value:Y,onValueChange:L,options:ec,placeholder:"Select reference sheet"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{children:"Match Column"}),(0,a.jsx)(j.P,{value:T,onValueChange:U,options:eo,placeholder:"Select column to match",disabled:!Y})]})]})]})]}),(0,a.jsxs)(N.Zb,{children:[(0,a.jsxs)(N.Ol,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(N.ll,{className:"text-lg",children:"Return Columns → Target Columns"}),(0,a.jsxs)(g.z,{size:"sm",variant:"outline",onClick:()=>{K(e=>[...e,{returnCol:-1,targetCol:-1}])},className:"gap-1",children:[(0,a.jsx)(i,{className:"h-3.5 w-3.5"}),"Add Mapping"]})]}),(0,a.jsxs)(N.aY,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{children:"Target Sheet"}),(0,a.jsx)(j.P,{value:A,onValueChange:H,options:ec,placeholder:"Select target sheet"})]}),I.map((e,l)=>(0,a.jsxs)("div",{className:"flex items-end gap-3 rounded-lg border bg-muted/30 p-3",children:[(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)(v._,{className:"text-xs",children:"Return Column (from reference)"}),(0,a.jsx)(j.P,{value:e.returnCol>=0?String(e.returnCol):"",onValueChange:e=>ex(l,"returnCol",Number(e)),options:eh,placeholder:"Select...",disabled:!Y})]}),(0,a.jsx)("div",{className:"text-muted-foreground pb-2",children:"→"}),(0,a.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,a.jsx)(v._,{className:"text-xs",children:"Target Column"}),(0,a.jsx)(j.P,{value:e.targetCol>=0?String(e.targetCol):"",onValueChange:e=>ex(l,"targetCol",Number(e)),options:eu,placeholder:"Select...",disabled:!A})]}),I.length>1&&(0,a.jsx)(g.z,{size:"icon",variant:"ghost",onClick:()=>em(l),className:"mb-0.5 h-8 w-8 text-muted-foreground hover:text-destructive",children:(0,a.jsx)(d,{className:"h-4 w-4"})})]},l))]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(g.z,{onClick:eg,disabled:!ep,className:"gap-2",children:["Run VLOOKUP",(0,a.jsx)(o.Z,{className:"h-4 w-4"})]})})]}),"preview"===M&&X&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,a.jsxs)(g.z,{variant:"outline",size:"sm",onClick:()=>_("configure"),className:"gap-1",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),"Back to Configure"]}),(0,a.jsxs)(f.C,{variant:"success",className:"gap-1",children:[(0,a.jsx)(h,{className:"h-3.5 w-3.5"}),$," matched"]}),J>0&&(0,a.jsxs)(f.C,{variant:"destructive",className:"gap-1",children:[(0,a.jsx)(c,{className:"h-3.5 w-3.5"}),J," not matched"]}),W>0&&(0,a.jsxs)(f.C,{variant:"warning",className:"gap-1",children:[(0,a.jsx)(m,{className:"h-3.5 w-3.5"}),W," duplicate keys in reference"]})]}),(0,a.jsx)(p.r,{headers:B,data:X,rowHighlights:el,highlightColumns:ea}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(g.z,{onClick:ej,className:"gap-2",children:["Export .xlsx",(0,a.jsx)(o.Z,{className:"h-4 w-4"})]})})]})]})}}},function(e){e.O(0,[425,851,489,971,117,744],function(){return e(e.s=9265)}),_N_E=e.O()}]);